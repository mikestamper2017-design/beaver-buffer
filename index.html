<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <style>
        body { margin: 0; background: #001f3f; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        canvas { border: 5px solid #fff; border-radius: 15px; }
    </style>
</head>
<body>
<script>
    const config = {
        type: Phaser.AUTO,
        width: 800,
        height: 800,
        scene: { preload: preload, create: create, update: update }
    };

    const game = new Phaser.Game(config);
    let beaver, rt, brush;

    function preload() {
        this.load.image('pond', 'pond.jpg'); 
        this.load.image('beaver', 'beaver.png');
        
        // Custom rake-shaped brush
        let graphics = this.make.graphics({ x: 0, y: 0, add: false });
        graphics.fillStyle(0xffffff, 1);
        graphics.fillRect(0, 0, 80, 20); // A horizontal rake shape
        graphics.generateTexture('brush', 80, 20);
    }

    function create() {
        // 1. Bottom Layer: The Beautiful Pond Art
        let pond = this.add.image(400, 400, 'pond').setDisplaySize(800, 800);
        
        // 2. The "Rough Ice" Layer
        rt = this.make.renderTexture({ width: 800, height: 800 }, false);
        rt.fill(0xffffff, 0.7); // Semi-transparent "snowy" white
        rt.setOrigin(0, 0);

        // 3. THE MAGIC: The Oval Mask (Ice Only)
        // This makes sure the "Rough Ice" only appears on the pond area
        let shape = this.make.graphics();
        shape.fillStyle(0xffffff);
        // Drawing an oval that fits your pond image
        shape.fillEllipse(400, 520, 650, 400); 
        let mask = shape.createGeometryMask();
        rt.setMask(mask);

        // 4. The Beaver
        beaver = this.add.sprite(400, 400, 'beaver');
        beaver.setScale(0.25); 
        
        brush = this.make.image({ key: 'brush' }, false);
    }

    function update() {
        let pointer = this.input.activePointer;
        if (pointer.isDown) {
            // Smooth beaver movement
            beaver.x = Phaser.Math.Linear(beaver.x, pointer.x, 0.15);
            beaver.y = Phaser.Math.Linear(beaver.y, pointer.y, 0.15);

            // Buffer the ice
            // We rotate the brush to match the beaver's direction
            rt.erase(brush, beaver.x, beaver.y + 30);
        }
    }
</script>
</body>
</html>
