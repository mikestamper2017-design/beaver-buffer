<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <style>
        body { margin: 0; background: #001f3f; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        canvas { border: 5px solid #fff; border-radius: 15px; }
    </style>
</head>
<body>
<script>
    const config = {
        type: Phaser.AUTO,
        width: 800,
        height: 800,
        scene: { preload: preload, create: create, update: update }
    };

    const game = new Phaser.Game(config);
    let beaver, rt, brush;

    function preload() {
        // The '?v=2' tricks your phone into loading the new version
        this.load.image('pond', 'pond.jpg?v=2'); 
        this.load.image('beaver', 'beaver.png?v=2');
        
        let graphics = this.make.graphics({ x: 0, y: 0, add: false });
        graphics.fillStyle(0xffffff, 1);
        graphics.fillCircle(30, 30, 30); // Rounder brush for smoother cleaning
        graphics.generateTexture('brush', 60, 60);
    }

    function create() {
        this.add.image(400, 400, 'pond').setDisplaySize(800, 800);
        
        rt = this.make.renderTexture({ width: 800, height: 800 }, false);
        rt.fill(0xcceeff, 0.6); // Light blue tint so we can see the ice
        rt.setOrigin(0, 0);

        // ADJUSTED MASK: Based on your screenshot, the pond is centered
        let shape = this.make.graphics();
        shape.fillStyle(0xffffff);
        shape.fillEllipse(400, 600, 600, 350); // Centered on the lower half pond
        let mask = shape.createGeometryMask();
        rt.setMask(mask);

        beaver = this.add.sprite(400, 400, 'beaver');
        beaver.setScale(0.25); 
        
        brush = this.make.image({ key: 'brush' }, false);
    }

    function update() {
        let pointer = this.input.activePointer;
        if (pointer.isDown) {
            beaver.x = Phaser.Math.Linear(beaver.x, pointer.x, 0.15);
            beaver.y = Phaser.Math.Linear(beaver.y, pointer.y, 0.15);

            // This is the cleaning action
            rt.erase('brush', beaver.x, beaver.y + 30);
        }
    }
</script>
</body>
</html>
